{
  "name": "agents.command",
  "version": "v1",
  "description": "Kernel sends command to specific agent for execution",
  "topic": "symbion/agents/command@v1",
  "direction": "kernel_to_agent",
  "schema": {
    "type": "object",
    "required": ["command_id", "agent_id", "command_type", "timestamp"],
    "properties": {
      "command_id": {
        "type": "string",
        "description": "Unique command identifier for tracking responses",
        "pattern": "^[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}$"
      },
      "agent_id": {
        "type": "string",
        "description": "Target agent identifier (MAC without colons)",
        "pattern": "^[a-fA-F0-9]{12}$"
      },
      "command_type": {
        "type": "string",
        "enum": [
          "shutdown",
          "reboot", 
          "hibernate",
          "kill_process",
          "run_command",
          "get_metrics",
          "list_processes",
          "get_system_info"
        ],
        "description": "Type of command to execute"
      },
      "parameters": {
        "type": "object",
        "description": "Command-specific parameters",
        "properties": {
          "pid": {
            "type": "integer",
            "description": "Process ID for kill_process command"
          },
          "command": {
            "type": "string",
            "description": "Shell command to execute for run_command",
            "maxLength": 1000
          },
          "timeout": {
            "type": "integer",
            "description": "Command timeout in seconds",
            "minimum": 1,
            "maximum": 300,
            "default": 30
          },
          "delay": {
            "type": "integer", 
            "description": "Delay before executing power commands (seconds)",
            "minimum": 0,
            "maximum": 300,
            "default": 0
          }
        }
      },
      "timestamp": {
        "type": "string",
        "format": "date-time",
        "description": "Command timestamp in ISO 8601 format"
      },
      "requester": {
        "type": "string",
        "description": "Who initiated the command (api, dashboard, etc.)",
        "default": "kernel"
      }
    }
  },
  "examples": [
    {
      "command_id": "550e8400-e29b-41d4-a716-446655440000",
      "agent_id": "a1b2c3d4e5f6",
      "command_type": "shutdown",
      "parameters": {
        "delay": 10
      },
      "timestamp": "2025-09-01T10:30:00Z",
      "requester": "api"
    },
    {
      "command_id": "550e8400-e29b-41d4-a716-446655440001", 
      "agent_id": "a1b2c3d4e5f6",
      "command_type": "kill_process",
      "parameters": {
        "pid": 1234
      },
      "timestamp": "2025-09-01T10:31:00Z",
      "requester": "dashboard"
    },
    {
      "command_id": "550e8400-e29b-41d4-a716-446655440002",
      "agent_id": "a1b2c3d4e5f6", 
      "command_type": "run_command",
      "parameters": {
        "command": "df -h",
        "timeout": 30
      },
      "timestamp": "2025-09-01T10:32:00Z",
      "requester": "api"
    }
  ]
}